%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% This template is created by Jiachen Ma under MIT License.  %
% Please use accordingly.                                    %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[12pt, oneside, toc=flat]{article}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{setspace} % for spacing
\singlespacing
\usepackage{parskip} % skip between paragraph
\setlength{\parskip}{1em}

% for table generated from https://www.tablesgenerator.com/#
\usepackage{booktabs}

% emoji
\usepackage{tikzsymbols}

% citation
%\usepackage{biblatex}
\usepackage[
backend=biber,
style=authoryear,
citestyle=authoryear
]{biblatex}
\setlength\bibitemsep{1.2\baselineskip} % sep between citations
\setlength\bibhang{1.5em} % indent sec line of entries by 0.375in
\bibliography{references.bib} % bib file

%\usepackage{natbib} % for citation
%\bibliographystyle{plain}
%\bibliographystyle{plain}
%\bibliography{references}

% doc general margin
\usepackage[a4paper, top=1in, bottom=1in, left=1.5in, right=1in]{geometry} 

% Times New Roman Font
\usepackage{fontspec}
\setmainfont[
Path = ./Fonts/,
BoldFont=timesbd.ttf,
ItalicFont=timesi.ttf,
BoldItalicFont=timesbi.ttf
]{times.ttf}

% modify section numbering
\renewcommand{\thesection}{\Roman{section}} 
\renewcommand{\thesubsection}{\thesection.\Alph{subsection}}

% modify figure indexing
\renewcommand{\thefigure}{\thesection-\arabic{figure}}

% modify page numbering
\usepackage{fancyhdr} 
\pagestyle{fancy}
\fancyhf{}
\fancyheadoffset{0cm}
\renewcommand{\headrulewidth}{0pt} 
\renewcommand{\footrulewidth}{0pt}
\fancyhead[R]{\thepage}

% define page numbering styles, call with \pagestyle{x_style}
\fancypagestyle{plain}{%
  \fancyhf{}%
  \fancyhead[R]{\thepage}%
}
\fancypagestyle{style1}{
\fancyhf{}
\fancyhead[C]{style 1 with thin line}
\fancyfoot[C]{\thepage}
\renewcommand{\headrulewidth}{0.4pt}
}
\fancypagestyle{cover}{
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
}
\fancypagestyle{preamble}{
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
\pagenumbering{roman}
\fancyheadoffset{0cm}
\fancyhead[R]{\thepage}
}
\fancypagestyle{body}{
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
\pagenumbering{arabic}
\fancyheadoffset{0cm}
\fancyhead[R]{\thepage}
}

% auto add perfix for reference
\usepackage{hyperref}

% modify toc title text
\renewcommand{\contentsname}{TABLE OF CONTENTS}

\usepackage{tocloft}
% adjust table of contents (toc) title and spacing
\renewcommand{\cfttoctitlefont}{\hspace*{\fill}\normalfont\normalsize\MakeUppercase}
\renewcommand{\cftaftertoctitle}{\hspace*{\fill}}
\renewcommand{\cftlottitlefont}{\hspace*{\fill}\normalfont\normalsize\MakeUppercase}
\renewcommand{\cftafterlottitle}{\hspace*{\fill}}
\renewcommand{\cftloftitlefont}{\hspace*{\fill}\normalfont\normalsize\MakeUppercase}
\renewcommand{\cftafterloftitle}{\hspace*{\fill}}

% adjust table of contents (toc) fonts and upcase
\usepackage{etoolbox}
\makeatletter
\patchcmd{\l@section}
    {\cftsecfont #1}
    {\cftsecfont {#1}}
    {}
    {}
\makeatother
\renewcommand\cftsecfont{\normalsize\MakeUppercase} 

\makeatletter
\patchcmd{\l@subsection}
    {\cftsubsecfont #1}
    {\cftsubsecfont {#1}}
    {}
    {}
\makeatother
\renewcommand\cftsubsecfont{\normalsize\textsc}  

\makeatletter
\patchcmd{\l@subsubsection}
    {\cftsubsubsecfont #1}
    {\cftsubsubsecfont {#1}}
    {}
    {}
\makeatother
\renewcommand\cftsubsubsecfont{\normalsize\textsc}  

% adjust toc num width
\makeatletter
\renewcommand{\numberline}[1]{%
  \@cftbsnum #1\@cftasnum~\@cftasnumb%
}
\makeatother

% modify toc section num
\renewcommand{\cftsecaftersnum}{.}

% modify toc page num font
\renewcommand{\cftsecpagefont}{\normalsize}

% add dot line for section toc
\renewcommand{\cftsecleader}{\cftdotfill{\cftdot}}
\renewcommand{\cftsubsecleader}{\cftdotfill{\cftdot}}
\renewcommand{\cftsubsubsecleader}{\cftdotfill{\cftdot}}

% add split env for equation
\usepackage{amsmath,amssymb,amsfonts}

%%%%%%%%%%%%%%%%%%%%%
\begin{document}
\let\ref\autoref

%----------------------------------------------------------------------------------------
\pagestyle{cover}
%----------------------------------------------------------------------------------------
% cover/title page
\input{Preamble/info}
\input{Preamble/cover}
\newpage
%----------------------------------------------------------------------------------------
% abstract page
\input{Preamble/abstract}
\newpage
%----------------------------------------------------------------------------------------
% table of content page
\pagestyle{preamble}
%----------------------------------------------------------------------------------------
\addcontentsline{toc}{section}{ACKNOWLEDGMENTS}
\input{Preamble/acknowledgments}
\cleardoublepage
\addcontentsline{toc}{section}{\listfigurename}
\input{Preamble/list of figures}
\cleardoublepage
\addcontentsline{toc}{section}{\listtablename}
\input{Preamble/list of tables}
\cleardoublepage
%\input{Preamble/table of contents}
\tableofcontents
\newpage
%----------------------------------------------------------------------------------------
\pagestyle{body}
%----------------------------------------------------------------------------------------
\section{Introduction}
\input{Body/introduction}
\newpage
%----------------------------------------------------------------------------------------
\input{Body/thesis statement}
\newpage
%----------------------------------------------------------------------------------------
\input{Body/existing literature}
\newpage
%----------------------------------------------------------------------------------------
\input{Body/overview}
\newpage
%----------------------------------------------------------------------------------------
\input{Body/approach}
\newpage
%----------------------------------------------------------------------------------------
\input{Body/potential outcomes}
\newpage
%----------------------------------------------------------------------------------------
\input{Body/limitations}
\newpage
%----------------------------------------------------------------------------------------
\input{Body/contributions to knowledge}
\newpage
%----------------------------------------------------------------------------------------
\input{Body/timeline}
\newpage
%----------------------------------------------------------------------------------------
\input{Body/reference}
\newpage
%----------------------------------------------------------------------------------------

\addcontentsline{toc}{section}{Chapter}

\end{document}
